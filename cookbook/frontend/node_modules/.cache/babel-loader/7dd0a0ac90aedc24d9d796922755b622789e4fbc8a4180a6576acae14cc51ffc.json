{"ast":null,"code":"import React,{useEffect,useState}from'react';import{getRecipes,deleteRecipe}from'../services/api';import RecipeCard from'../components/RecipeCard';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const RecipesPage=()=>{const[recipes,setRecipes]=useState([]);const[filteredRecipes,setFilteredRecipes]=useState([]);const[searchQuery,setSearchQuery]=useState('');const[selectedCategory,setSelectedCategory]=useState('All');const navigate=useNavigate();useEffect(()=>{fetchRecipes();},[]);useEffect(()=>{filterRecipes();},[searchQuery,selectedCategory,recipes]);// Fetch recipes from the backend\nconst fetchRecipes=async()=>{try{const data=await getRecipes();console.log('Fetched recipes:',data);setRecipes(data);setFilteredRecipes(data);}catch(error){console.error('Error fetching recipes:',error);}};const handleDeleteRecipe=async id=>{try{console.log(`Attempting to delete recipe with id: ${id}`);await deleteRecipe(id);// Call the delete API\nconsole.log(`Successfully deleted recipe with id: ${id}`);// Remove the deleted recipe from local state\nsetRecipes(prevRecipes=>prevRecipes.filter(recipe=>recipe._id!==id));console.log('Recipe list successfully updated.');}catch(error){console.error('Error deleting recipe:',error);}};const handleEditRecipe=recipe=>{navigate('/',{state:{recipe}});};// Filter recipes based on search query and category\nconst filterRecipes=()=>{let filtered=recipes;if(searchQuery){const lowerCaseQuery=searchQuery.toLowerCase();filtered=filtered.filter(recipe=>{var _recipe$title,_recipe$category,_recipe$ingredients;// Ensure fields are strings or arrays before matching\nconst title=((_recipe$title=recipe.title)===null||_recipe$title===void 0?void 0:_recipe$title.toLowerCase())||'';const category=((_recipe$category=recipe.category)===null||_recipe$category===void 0?void 0:_recipe$category.toLowerCase())||'';const ingredients=Array.isArray(recipe.ingredients)?recipe.ingredients.join(' ').toLowerCase():((_recipe$ingredients=recipe.ingredients)===null||_recipe$ingredients===void 0?void 0:_recipe$ingredients.toLowerCase())||'';// Check for matches in title, category, or ingredients\nreturn title.includes(lowerCaseQuery)||category.includes(lowerCaseQuery)||ingredients.includes(lowerCaseQuery);});}if(selectedCategory!=='All'){filtered=filtered.filter(recipe=>{var _recipe$category2;return((_recipe$category2=recipe.category)===null||_recipe$category2===void 0?void 0:_recipe$category2.toLowerCase())===selectedCategory.toLowerCase();});}setFilteredRecipes(filtered);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{className:\"text-white py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"row align-items-center justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12 text-center\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[\"Cookbook\",/*#__PURE__*/_jsx(\"br\",{}),\"Recipes Page\"]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row align-items-center justify-content-center mt-3\",children:/*#__PURE__*/_jsxs(\"nav\",{children:[/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",children:\"Recipes\"})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",class:\"search-bar\",placeholder:\"Search recipes by title, category, or ingredients\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{class:\"category-filter\",value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"All\",children:\"All Categories\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Breakfast\",children:\"Breakfast\"}),/*#__PURE__*/_jsx(\"option\",{value:\"First Course\",children:\"First Course\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Second Course\",children:\"Second Course\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Dessert\",children:\"Dessert\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:filteredRecipes.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"No recipes found. Try adjusting your search or filters.\"}):filteredRecipes.map(recipe=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 mb-4\",children:/*#__PURE__*/_jsx(RecipeCard,{recipe:recipe,onEdit:()=>handleEditRecipe(recipe),onDelete:()=>handleDeleteRecipe(recipe._id)},recipe._id)},recipe._id))})]})]});};export default RecipesPage;","map":{"version":3,"names":["React","useEffect","useState","getRecipes","deleteRecipe","RecipeCard","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RecipesPage","recipes","setRecipes","filteredRecipes","setFilteredRecipes","searchQuery","setSearchQuery","selectedCategory","setSelectedCategory","navigate","fetchRecipes","filterRecipes","data","console","log","error","handleDeleteRecipe","id","prevRecipes","filter","recipe","_id","handleEditRecipe","state","filtered","lowerCaseQuery","toLowerCase","_recipe$title","_recipe$category","_recipe$ingredients","title","category","ingredients","Array","isArray","join","includes","_recipe$category2","children","className","href","class","type","placeholder","value","onChange","e","target","length","map","onEdit","onDelete"],"sources":["C:/Users/danie/Documents/R0314-MERN/cookbook/frontend/src/pages/RecipesPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { getRecipes, deleteRecipe } from '../services/api';\r\nimport RecipeCard from '../components/RecipeCard';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst RecipesPage = () => {\r\n  const [recipes, setRecipes] = useState([]);\r\n  const [filteredRecipes, setFilteredRecipes] = useState([]);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedCategory, setSelectedCategory] = useState('All');\r\n\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetchRecipes();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    filterRecipes();\r\n  }, [searchQuery, selectedCategory, recipes]);\r\n\r\n  // Fetch recipes from the backend\r\n  const fetchRecipes = async () => {\r\n    try {\r\n      const data = await getRecipes();\r\n      console.log('Fetched recipes:', data);\r\n      setRecipes(data);\r\n      setFilteredRecipes(data);\r\n    } catch (error) {\r\n      console.error('Error fetching recipes:', error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteRecipe = async (id) => {\r\n    try {\r\n      console.log(`Attempting to delete recipe with id: ${id}`);\r\n      await deleteRecipe(id); // Call the delete API\r\n      console.log(`Successfully deleted recipe with id: ${id}`);\r\n      // Remove the deleted recipe from local state\r\n      setRecipes((prevRecipes) => prevRecipes.filter((recipe) => recipe._id !== id));\r\n      console.log('Recipe list successfully updated.');\r\n    } catch (error) {\r\n      console.error('Error deleting recipe:', error);\r\n    }\r\n  };\r\n\r\n  const handleEditRecipe = (recipe) => {\r\n    navigate('/', { state: { recipe } });\r\n  };\r\n\r\n  // Filter recipes based on search query and category\r\n  const filterRecipes = () => {\r\n    let filtered = recipes;\r\n  \r\n    if (searchQuery) {\r\n      const lowerCaseQuery = searchQuery.toLowerCase();\r\n  \r\n      filtered = filtered.filter((recipe) => {\r\n        // Ensure fields are strings or arrays before matching\r\n        const title = recipe.title?.toLowerCase() || '';\r\n        const category = recipe.category?.toLowerCase() || '';\r\n        const ingredients = Array.isArray(recipe.ingredients)\r\n          ? recipe.ingredients.join(' ').toLowerCase()\r\n          : recipe.ingredients?.toLowerCase() || '';\r\n  \r\n        // Check for matches in title, category, or ingredients\r\n        return (\r\n          title.includes(lowerCaseQuery) ||\r\n          category.includes(lowerCaseQuery) ||\r\n          ingredients.includes(lowerCaseQuery)\r\n        );\r\n      });\r\n    }\r\n  \r\n    if (selectedCategory !== 'All') {\r\n      filtered = filtered.filter(\r\n        (recipe) => recipe.category?.toLowerCase() === selectedCategory.toLowerCase()\r\n      );\r\n    }\r\n  \r\n    setFilteredRecipes(filtered);\r\n  };\r\n  \r\n\r\n  return (\r\n    <>\r\n      <header className=\"text-white py-3\">\r\n        <div className=\"container\">\r\n          <div className=\"row align-items-center justify-content-center\">\r\n            <div className=\"col-12 text-center\">\r\n              <h1>Cookbook<br/>Recipes Page</h1>\r\n            </div>\r\n          </div>\r\n          <div className=\"row align-items-center justify-content-center mt-3\">\r\n            <nav>\r\n              <a href=\"/\">\r\n                Home\r\n              </a>\r\n              <a href=\"#\">\r\n                Recipes\r\n              </a>\r\n            </nav>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"container mt-4\">\r\n      <div class=\"search-container\">\r\n  <input\r\n    type=\"text\"\r\n    class=\"search-bar\"\r\n    placeholder=\"Search recipes by title, category, or ingredients\"\r\n    value={searchQuery}\r\n    onChange={(e) => setSearchQuery(e.target.value)}\r\n  />\r\n  <select\r\n    class=\"category-filter\"\r\n    value={selectedCategory}\r\n    onChange={(e) => setSelectedCategory(e.target.value)}\r\n  >\r\n    <option value=\"All\">All Categories</option>\r\n    <option value=\"Breakfast\">Breakfast</option>\r\n    <option value=\"First Course\">First Course</option>\r\n    <option value=\"Second Course\">Second Course</option>\r\n    <option value=\"Dessert\">Dessert</option>\r\n  </select>\r\n</div>\r\n\r\n        {/* Recipes Grid */}\r\n        <div className=\"row\">\r\n          {filteredRecipes.length === 0 ? (\r\n            <p className=\"text-center\">No recipes found. Try adjusting your search or filters.</p>\r\n          ) : (\r\n            filteredRecipes.map((recipe) => (\r\n              <div className=\"col-md-4 mb-4\" key={recipe._id}>\r\n              <RecipeCard\r\n                key={recipe._id}\r\n                recipe={recipe}\r\n                onEdit={() => handleEditRecipe(recipe)}\r\n                onDelete={() => handleDeleteRecipe(recipe._id)}\r\n              />\r\n            </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RecipesPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}